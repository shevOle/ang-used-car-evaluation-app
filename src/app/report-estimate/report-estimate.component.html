<section class="estimate-page">
  <ucea-form-card class="form-card">
    <form
      class="estimate-page-form"
      [formGroup]="estimateForm"
      (submit)="submitEstimateForm()"
    >
      <div class="estimate-page-form-input">
        <mat-form-field>
          <input
            matInput
            [formControl]="estimateForm.controls.make"
            type="text"
            required
            placeholder="Manufacturer*"
          />
        </mat-form-field>
      </div>

      <div class="estimate-page-form-input">
        <mat-form-field>
          <input
            matInput
            [formControl]="estimateForm.controls.model"
            type="text"
            required
            placeholder="Model*"
          />
        </mat-form-field>
      </div>

      <div class="estimate-page-form-input">
        <mat-form-field>
          <input
            matInput
            [formControl]="estimateForm.controls.year"
            type="number"
            required
            placeholder="Production year*"
          />
        </mat-form-field>
      </div>

      <ucea-button
        [disabled]="!estimateForm.valid"
        label="Get estimate!"
        visual="main"
        [onClick]="submitEstimateForm.bind(this)"
        class="submit-button"
      ></ucea-button>

      <div class="estimate-page-form-input-errors">
        <p
          *ngIf="make.invalid && make.touched && make.dirty && make.errors?.['required']"
        >
          Manufacturer is required.
        </p>
        <p
          *ngIf="make.invalid && make.touched && make.dirty && make.errors?.['invalid']"
        >
          Manufacturer should be a string.
        </p>
        <p
          *ngIf="model.invalid && model.touched && model.dirty && model.errors?.['required']"
        >
          Model is required.
        </p>
        <p
          *ngIf="model.invalid && model.touched && model.dirty && model.errors?.['invalid']"
        >
          Model should be a string.
        </p>
        <p
          *ngIf="year.invalid && year.touched && year.dirty && year.errors?.['required']"
        >
          Production year is required.
        </p>
        <p
          *ngIf="year.invalid && year.touched && year.dirty && year.errors?.['invalid']"
        >
          Production year should be a number.
        </p>
        <p
          *ngIf="year.invalid && year.touched && year.dirty && year.errors?.['max']"
        >
          Production year can't be greater than {{ currentYear }}.
        </p>
        <p
          *ngIf="year.invalid && year.touched && year.dirty && year.errors?.['min']"
        >
          Production year can't be less than 1990.
        </p>
      </div>
    </form>
  </ucea-form-card>
  <div id="estimate-page-map"></div>

  <div *ngIf="($similarReports | async)?.length" class="estimate-page-price">
    <p>
      Estimate price for {{ estimateForm.value.make }}
      {{ estimateForm.value.model }} manufactured in
      {{ estimateForm.value.year }} is {{ estimatePrice | currency }}
    </p>
  </div>
  <div *ngIf="!($similarReports | async)?.length" class="estimate-page-price">
    No reports found for your search
  </div>

  <div *ngIf="($similarReports | async)?.length" class="estimate-page-reports">
    <h4>Reports that does satisfy your requirements:</h4>
    <div class="estimate-page-reports-grid">
      <ucea-report
        *ngFor="let report of $similarReports | async"
        [report]="report"
      ></ucea-report>
    </div>
  </div>
</section>
